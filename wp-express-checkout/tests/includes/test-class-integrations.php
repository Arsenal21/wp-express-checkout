<?php

namespace WP_Express_Checkout;

/**
 * Generated by PHPUnit_SkeletonGenerator on 2021-06-28 at 07:52:47.
 *
 * @group integrations
 *
 * @covers WP_Express_Checkout\Integrations
 */
class IntegrationsTest extends \WP_UnitTestCase {

	/**
	 * @var Integrations
	 */
	protected $object;

	/**
	 * Sets up the fixture, for example, opens a network connection.
	 * This method is called before a test is executed.
	 */
	public function setUp() {
		if ( ! defined( 'WP_LICENSE_MANAGER_VERSION' ) ) {
			define( 'WP_LICENSE_MANAGER_VERSION', '1.0-test' );
		}
		$this->object = new Integrations;
	}

	public function test_fallback_subscription_type__post_to_product() {
		$product = $this->factory->post->create_and_get(
			[
				'post_type' => \WP_Express_Checkout\Products::$products_slug,
			]
		);

		$this->assertInstanceOf( 'WP_Express_Checkout\Products\One_Time_Product', $this->object->fallback_subscription_type( $product ) );
	}

	public function test_fallback_subscription_type__product_to_product() {
		$post = $this->factory->post->create_and_get(
			[
				'post_type' => \WP_Express_Checkout\Products::$products_slug,
				'meta_input' => [
					'wpec_product_type' => 'test'
				],
			]
		);

		$product = new Products\Test_Product( $post );

		$this->assertInstanceOf( 'WP_Express_Checkout\Products\Test_Product', $this->object->fallback_subscription_type( $product ) );
	}

}
